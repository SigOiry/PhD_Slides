#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = T)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
label = "D"),
size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))
ggsave("Images/Part2/Belon_angle.png",angle_plot,width = 10, height = 4.44, dpi = 400)
DISCOV_Belon <- ggplot()+
tidyterra::geom_spatraster(data = DISCOV_rast,
mapping = aes(fill = layer),
maxcell = 500832*8)+
scale_fill_manual(breaks = c(1,2,3,4,5,6,8),
values=c("#DAA520","#b3ff1a","#389318","#873e23","#b3002d","#a2a3a2","#42c9bc",NA,NA),
na.value = NA,
name = "Classes",
labels = c("Bacillariophyceae",
"Chlorophyceae",
"Magnoliopsida",
"Phaeophyceae",
"Florideophyceae",
"Sediment",
"Water"))+
# geom_text(aes(x =  ext(DISCOV_rast)[1]+0.04*(ext(DISCOV_rast)[2]-ext(DISCOV_rast)[1]),
#               y =  ext(DISCOV_rast)[4]-0.08*(ext(DISCOV_rast)[4]-ext(DISCOV_rast)[3]),
#               label = "A"),
#               size = 10)+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
theme_Bede_Map()+
# coord_equal()+
theme(
# axis.text.x = element_text(size = 10, angle = -20, color = NA,hjust = 0),
axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.title = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_DISCOV_void.png",DISCOV_Belon,width = 10, height = 4.44, dpi = 400)
DISCOV_Belon <- ggplot()+
tidyterra::geom_spatraster(data = DISCOV_rast,
mapping = aes(fill = layer),
maxcell = 500832*8,
show.legend = F)+
scale_fill_manual(breaks = c(1,2,3,4,5,6,8),
values=c("#DAA520","#b3ff1a","#389318","#873e23","#b3002d","#a2a3a2","#42c9bc",NA,NA),
na.value = NA,
name = "Classes",
labels = c("Bacillariophyceae",
"Chlorophyceae",
"Magnoliopsida",
"Phaeophyceae",
"Florideophyceae",
"Sediment",
"Water"))+
# geom_text(aes(x =  ext(DISCOV_rast)[1]+0.04*(ext(DISCOV_rast)[2]-ext(DISCOV_rast)[1]),
#               y =  ext(DISCOV_rast)[4]-0.08*(ext(DISCOV_rast)[4]-ext(DISCOV_rast)[3]),
#               label = "A"),
#               size = 10)+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
theme_Bede_Map()+
# coord_equal()+
theme(
# axis.text.x = element_text(size = 10, angle = -20, color = NA,hjust = 0),
axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
axis.title = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_DISCOV_void.png",DISCOV_Belon,width = 10, height = 4.44, dpi = 400)
bathy_Belon <- ggplot()+
# tidyterra::geom_spatraster_rgb(data = Belon_RGB,
#       r = 1,
#       g = 2,
#       b = 3,
#       maxcell = 1000,
#       alpha = 0
#       )+
tidyterra::geom_spatraster(data = DEM_rast,
mapping = aes(fill = Belon_DEM_LiDAR ),
maxcell = 500832,
show.legend = F)+
scale_fill_scico(palette = "batlow",
na.value = NA,
name = "Elevation",
breaks = c(0,1.5,3),
limits = c(0,3),
labels = c("0 m","1.5 m", "3 m")) +
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "C"),
#               size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_Bathy_void.png",bathy_Belon,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = F)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
label = "D"),
size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_angle_void.png",angle_plot,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = T)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
size = 10)+
ggsave("Images/Part2/Belon_angle.png",angle_plot,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = F)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
#               size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_angle_void.png",angle_plot,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = T)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
# size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))
ggsave("Images/Part2/Belon_angle.png",angle_plot,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = F)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Angle",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
#               size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_angle_void.png",angle_plot,width = 10, height = 4.44, dpi = 400)
#| cache: false
#| echo: false
#| warning: false
#| eval: false
msk <- "Data/Part2/Belon/Belon_DEM_32630.shp" %>%
read_sf()
Belon_RGB <- "Data/Part2/Belon/Belon_RGB_MULTI.tif" %>%
rast() %>%
crop(msk, mask = T)
DEM_rast <- rast("Data/Part2/Belon/Belon_DEM_LiDAR.tif") %>%
crop(msk, mask = T)
Angle_df<-read_csv("Data/Part2/FullDF_10timesResample_DEMSlope_PredPercent.csv") %>%
dplyr::filter(Site  == "Belon")
angle_rast <- Angle_df %>%
dplyr::select(x,y,Slope_Cat) %>%
mutate(Slope_Cat = case_when(Slope_Cat == "Slope" ~ 1,
Slope_Cat == "Flat" ~ 2,
Slope_Cat == "Vertical" ~ 3)) %>%
terra::rast(type="xyz", crs="EPSG:32630") %>%
crop(msk, mask = T) %>%
as.factor()
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = T)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Slope",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
# size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))
ggsave("Images/Part2/Belon_angle.png",angle_plot,width = 10, height = 4.44, dpi = 400)
angle_plot <- ggplot()+
#   tidyterra::geom_spatraster(data = DEM_rast,
#                              mapping = aes(fill = Belon_DEM_LiDAR ),
#                              maxcell = 100,
#                              alpha=0,
#                              show.legend = F)+
# scico::scale_fill_scico(palette = "batlow", na.value = NA,
#                  name = "Bathymetry",
#                  breaks = c(0,1.5,3),
#                  limits = c(0,3),
#                  labels = c("0 m","1.5 m", "3 m"))+
# ggnewscale::new_scale_fill()+
# geom_tile(Angle_df, mapping = aes(x = x, y = y, fill = Slope_Cat)) +
tidyterra::geom_spatraster(data = angle_rast,
mapping = aes(fill = Slope_Cat  ),
maxcell = 1310*581,
# alpha=0,
show.legend = F)+
scale_fill_manual(breaks = c(2,1,3),
values=c("#8E7CC3", "#76A5AF", "#93C47D"),
na.value = NA,
name = "Slope",
labels = c("Flat",
"Angled",
"Steep"))+
# geom_sf(data = msk, fill = "white", color = "white",show.legend = F)+
# geom_text(aes(x =  ext(Belon_RGB)[1]+0.04*(ext(Belon_RGB)[2]-ext(Belon_RGB)[1]),
#               y =  ext(Belon_RGB)[4]-0.08*(ext(Belon_RGB)[4]-ext(Belon_RGB)[3]),
#               label = "D"),
#               size = 10)+
theme_Bede_Map()+
coord_sf(expand = F,
xlim = c(450180.4, 451247.2+18),
ylim = c(5296561, 5297042))+
# coord_equal()+
theme(axis.text.y = element_text(size = 10, vjust=-8, hjust=0.5, angle = 90),
axis.text.x = element_text(size = 10, vjust=8, hjust=0.5),
axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
plot.background = element_rect(fill = "white", color = NA),
axis.title = element_blank(),
panel.background = element_blank(),  # No panel background
legend.background = element_blank(),
legend.position = c(0.98, 0.98),
legend.text = element_text(size = 10),
legend.key.size = unit(0.5, "cm"),
plot.margin = margin(0, 0, -10, -10))+
theme_void()
ggsave("Images/Part2/Belon_angle_void.png",angle_plot,width = 10, height = 4.44, dpi = 400)
