ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 200)
SP1<-read.csv("Data/Part1/Spectra_VIP.csv") %>%
dplyr::select(-X) %>%
mutate(type = "Min/Max Standardised Spectra") %>%
dplyr::filter(Class != "Bare Sediment",
Class != "Sun Glint",
Class != "Water",
Class != "Xanthophyceae",
Class != "A - MagnoliopsidaL") %>%
as_tibble()%>%
rename(value = "STD") %>%
dplyr::filter(Class == "C - Rhodophyceae") %>%
dplyr::select(Species_Group = "Class", Mean_Reflec = "value", Wavelength) %>%
mutate(Mean_Reflec = case_when(Wavelength %in% c(531,560,650) ~ Mean_Reflec *0.25,
Wavelength %in% c(668) ~ Mean_Reflec *0.2,
T ~ Mean_Reflec))
plot_SRF_sp <- DataCombo %>%
as_tibble() %>%
dplyr::filter(
Species_Group %in% c("Magnoliopsida","Ulvophyceae","Phaeophyceae","Bacillariophyceae"),
Data == "Drone",
Rep == "Rep_1") %>%
dplyr::select(Wavelength,Species_Group,Mean_Reflec)  %>%
bind_rows(SP1) %>%
mutate(Species_Group = case_when(Species_Group == "C - Rhodophyceae" ~ "Florideophyceae",
T ~ Species_Group))
(SP_plot<-plot_SRF_sp %>%
# dplyr::filter(Class %in% c("D - Chloropyceae", "A - Magnoliopsida")) %>%
ggplot(aes( x = Wavelength, y = Mean_Reflec, color = Species_Group))+
geom_line(linewidth = 1.5)+
# facet_wrap(~ type, scale = "free",ncol =1) +
scale_color_manual(values=c( "#DAA520", "#b3002d","#389318", "#873e23", "#b3ff1a"))+
ylab("Reflectance")+
xlab("Wavelength (nm)")+
theme_Bede()+
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
strip.text = element_text(size=25),
legend.position = c(0.2, 0.7),
plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
legend.title=element_blank(),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"),
legend.text.align = 0,
panel.border = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color="black"))
)
VIP<-"Data/Part1/NN_VIP_byClass_NoXanth.csv" %>%
read.csv() %>%
mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %>%
dplyr::select(-c(Magnoliosida ,Low_SPC))
VIP1<-VIP %>%
dplyr::select(-c(Water,
SunGlint,
Deep_Sediment,
Bare_Sediment)) %>%
# dplyr::filter(!str_detect(X,"NDVI")) %>%
mutate(isSTD = case_when(str_detect(X,"Stan") ~ "Standardised",
TRUE ~ "RAW")) %>%
pivot_longer(-c(X,isSTD), names_to = "Class",values_to = "value") %>%
dplyr::filter(X != "NDVI",
X != "NDVI_Stan") %>%
group_by(Class) %>%
mutate(STD = (value-min(value))/(max(value)-min(value))) %>%
ungroup() %>%
mutate(Class = case_when(Class == "Magnoliosida" ~ "Magnoliopsida",
Class == "Low_SPC" ~ "Magnoliopsida",
Class == "Clorophyta" ~ "Chlorophyceae",
Class == "Rhodphyta" ~ "Rhodophyceae",
Class == "MPB" ~ "Bacillariophyceae",
Class == "Phaeophyta" ~ "Phaeophyceae",
TRUE ~ Class),
Variable = str_replace_all(str_replace_all(str_replace_all(X,"Reflectance",""),"Stan",""),"_","")) %>%
dplyr::filter(Class != "Total")
VIP_summarised<-VIP1 %>%
group_by(Variable, Class) %>%
dplyr::summarise(sumVIP = sum(STD)) %>%
ungroup() %>%
group_by(Class) %>%
mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))
(VIP_subPLOT<-VIP_summarised %>%
dplyr::filter(Class %in% c("Magnoliopsida", "Chlorophyceae")) %>%
ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 200)
(SP_plot<-plot_SRF_sp %>%
# dplyr::filter(Class %in% c("D - Chloropyceae", "A - Magnoliopsida")) %>%
ggplot(aes( x = Wavelength, y = Mean_Reflec, color = Species_Group))+
geom_line(linewidth = 2)+
# facet_wrap(~ type, scale = "free",ncol =1) +
scale_color_manual(values=c( "#DAA520", "#b3002d","#389318", "#873e23", "#b3ff1a"))+
ylab("Reflectance")+
xlab("Wavelength (nm)")+
theme_Bede()+
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
strip.text = element_text(size=25),
legend.position = c(0.2, 0.7),
plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(1.5, "cm"),
legend.text.align = 0,
panel.border = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color="black"))
)
VIP<-"Data/Part1/NN_VIP_byClass_NoXanth.csv" %>%
read.csv() %>%
mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %>%
dplyr::select(-c(Magnoliosida ,Low_SPC))
VIP1<-VIP %>%
dplyr::select(-c(Water,
SunGlint,
Deep_Sediment,
Bare_Sediment)) %>%
# dplyr::filter(!str_detect(X,"NDVI")) %>%
mutate(isSTD = case_when(str_detect(X,"Stan") ~ "Standardised",
TRUE ~ "RAW")) %>%
pivot_longer(-c(X,isSTD), names_to = "Class",values_to = "value") %>%
dplyr::filter(X != "NDVI",
X != "NDVI_Stan") %>%
group_by(Class) %>%
mutate(STD = (value-min(value))/(max(value)-min(value))) %>%
ungroup() %>%
mutate(Class = case_when(Class == "Magnoliosida" ~ "Magnoliopsida",
Class == "Low_SPC" ~ "Magnoliopsida",
Class == "Clorophyta" ~ "Chlorophyceae",
Class == "Rhodphyta" ~ "Rhodophyceae",
Class == "MPB" ~ "Bacillariophyceae",
Class == "Phaeophyta" ~ "Phaeophyceae",
TRUE ~ Class),
Variable = str_replace_all(str_replace_all(str_replace_all(X,"Reflectance",""),"Stan",""),"_","")) %>%
dplyr::filter(Class != "Total")
VIP_summarised<-VIP1 %>%
group_by(Variable, Class) %>%
dplyr::summarise(sumVIP = sum(STD)) %>%
ungroup() %>%
group_by(Class) %>%
mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))
(VIP_subPLOT<-VIP_summarised %>%
dplyr::filter(Class %in% c("Magnoliopsida", "Chlorophyceae")) %>%
ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 200)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 300)
plot_SRF_sp <- DataCombo %>%
as_tibble() %>%
dplyr::filter(
Species_Group %in% c("Magnoliopsida","Ulvophyceae","Phaeophyceae","Bacillariophyceae"),
Data == "Drone",
Rep == "Rep_1") %>%
dplyr::select(Wavelength,Species_Group,Mean_Reflec)  %>%
bind_rows(SP1) %>%
mutate(Species_Group = case_when(Species_Group == "C - Rhodophyceae" ~ "Florideophyceae",
Species_Group == "Ulvophyceae" ~ "Chlorophyceae",
T ~ Species_Group))
(SP_plot<-plot_SRF_sp %>%
# dplyr::filter(Class %in% c("D - Chloropyceae", "A - Magnoliopsida")) %>%
ggplot(aes( x = Wavelength, y = Mean_Reflec, color = Species_Group))+
geom_line(linewidth = 2)+
# facet_wrap(~ type, scale = "free",ncol =1) +
scale_color_manual(values=c( "#DAA520", "#b3002d","#389318", "#873e23", "#b3ff1a"))+
ylab("Reflectance")+
xlab("Wavelength (nm)")+
theme_Bede()+
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
strip.text = element_text(size=25),
legend.position = c(0.2, 0.7),
plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(1.5, "cm"),
legend.text.align = 0,
panel.border = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color="black"))
)
VIP<-"Data/Part1/NN_VIP_byClass_NoXanth.csv" %>%
read.csv() %>%
mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %>%
dplyr::select(-c(Magnoliosida ,Low_SPC))
VIP1<-VIP %>%
dplyr::select(-c(Water,
SunGlint,
Deep_Sediment,
Bare_Sediment)) %>%
# dplyr::filter(!str_detect(X,"NDVI")) %>%
mutate(isSTD = case_when(str_detect(X,"Stan") ~ "Standardised",
TRUE ~ "RAW")) %>%
pivot_longer(-c(X,isSTD), names_to = "Class",values_to = "value") %>%
dplyr::filter(X != "NDVI",
X != "NDVI_Stan") %>%
group_by(Class) %>%
mutate(STD = (value-min(value))/(max(value)-min(value))) %>%
ungroup() %>%
mutate(Class = case_when(Class == "Magnoliosida" ~ "Magnoliopsida",
Class == "Low_SPC" ~ "Magnoliopsida",
Class == "Clorophyta" ~ "Chlorophyceae",
Class == "Rhodphyta" ~ "Rhodophyceae",
Class == "MPB" ~ "Bacillariophyceae",
Class == "Phaeophyta" ~ "Phaeophyceae",
TRUE ~ Class),
Variable = str_replace_all(str_replace_all(str_replace_all(X,"Reflectance",""),"Stan",""),"_","")) %>%
dplyr::filter(Class != "Total")
VIP_summarised<-VIP1 %>%
group_by(Variable, Class) %>%
dplyr::summarise(sumVIP = sum(STD)) %>%
ungroup() %>%
group_by(Class) %>%
mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))
(VIP_subPLOT<-VIP_summarised %>%
dplyr::filter(Class %in% c("Magnoliopsida", "Chlorophyceae")) %>%
ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 300)
(SP_plot<-plot_SRF_sp %>%
# dplyr::filter(Class %in% c("D - Chloropyceae", "A - Magnoliopsida")) %>%
ggplot(aes( x = Wavelength, y = Mean_Reflec, color = Species_Group))+
geom_line(linewidth = 2)+
# facet_wrap(~ type, scale = "free",ncol =1) +
scale_color_manual(values=c( "#DAA520", "#b3ff1a", "#b3002d","#389318", "#873e23"))+
ylab("Reflectance")+
xlab("Wavelength (nm)")+
theme_Bede()+
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
strip.text = element_text(size=25),
legend.position = c(0.2, 0.7),
plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(1.5, "cm"),
legend.text.align = 0,
panel.border = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color="black"))
)
VIP<-"Data/Part1/NN_VIP_byClass_NoXanth.csv" %>%
read.csv() %>%
mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %>%
dplyr::select(-c(Magnoliosida ,Low_SPC))
VIP1<-VIP %>%
dplyr::select(-c(Water,
SunGlint,
Deep_Sediment,
Bare_Sediment)) %>%
# dplyr::filter(!str_detect(X,"NDVI")) %>%
mutate(isSTD = case_when(str_detect(X,"Stan") ~ "Standardised",
TRUE ~ "RAW")) %>%
pivot_longer(-c(X,isSTD), names_to = "Class",values_to = "value") %>%
dplyr::filter(X != "NDVI",
X != "NDVI_Stan") %>%
group_by(Class) %>%
mutate(STD = (value-min(value))/(max(value)-min(value))) %>%
ungroup() %>%
mutate(Class = case_when(Class == "Magnoliosida" ~ "Magnoliopsida",
Class == "Low_SPC" ~ "Magnoliopsida",
Class == "Clorophyta" ~ "Chlorophyceae",
Class == "Rhodphyta" ~ "Rhodophyceae",
Class == "MPB" ~ "Bacillariophyceae",
Class == "Phaeophyta" ~ "Phaeophyceae",
TRUE ~ Class),
Variable = str_replace_all(str_replace_all(str_replace_all(X,"Reflectance",""),"Stan",""),"_","")) %>%
dplyr::filter(Class != "Total")
VIP_summarised<-VIP1 %>%
group_by(Variable, Class) %>%
dplyr::summarise(sumVIP = sum(STD)) %>%
ungroup() %>%
group_by(Class) %>%
mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))
(VIP_subPLOT<-VIP_summarised %>%
dplyr::filter(Class %in% c("Magnoliopsida", "Chlorophyceae")) %>%
ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 300)
SP_plot
SP1<-read.csv("Data/Part1/Spectra_VIP.csv") %>%
dplyr::select(-X) %>%
mutate(type = "Min/Max Standardised Spectra") %>%
dplyr::filter(Class != "Bare Sediment",
Class != "Sun Glint",
Class != "Water",
Class != "Xanthophyceae",
Class != "A - MagnoliopsidaL") %>%
as_tibble()%>%
rename(value = "STD") %>%
dplyr::filter(Class == "C - Rhodophyceae") %>%
dplyr::select(Species_Group = "Class", Mean_Reflec = "value", Wavelength) %>%
mutate(Mean_Reflec = case_when(Wavelength %in% c(531,560,650) ~ Mean_Reflec *0.15,
Wavelength %in% c(668) ~ Mean_Reflec *0.1,
T ~ Mean_Reflec))
plot_SRF_sp <- DataCombo %>%
as_tibble() %>%
dplyr::filter(
Species_Group %in% c("Magnoliopsida","Ulvophyceae","Phaeophyceae","Bacillariophyceae"),
Data == "Drone",
Rep == "Rep_1") %>%
dplyr::select(Wavelength,Species_Group,Mean_Reflec)  %>%
bind_rows(SP1) %>%
mutate(Species_Group = case_when(Species_Group == "C - Rhodophyceae" ~ "Florideophyceae",
Species_Group == "Ulvophyceae" ~ "Chlorophyceae",
T ~ Species_Group))
(SP_plot<-plot_SRF_sp %>%
# dplyr::filter(Class %in% c("D - Chloropyceae", "A - Magnoliopsida")) %>%
ggplot(aes( x = Wavelength, y = Mean_Reflec, color = Species_Group))+
geom_line(linewidth = 2)+
# facet_wrap(~ type, scale = "free",ncol =1) +
scale_color_manual(values=c( "#DAA520", "#b3ff1a", "#b3002d","#389318", "#873e23"))+
ylab("Reflectance")+
xlab("Wavelength (nm)")+
theme_Bede()+
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25),
strip.text = element_text(size=25),
legend.position = c(0.2, 0.7),
plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
legend.title=element_blank(),
legend.text = element_text(size = 20),
legend.key.size = unit(1.5, "cm"),
legend.text.align = 0,
panel.border = element_blank(),
panel.background = element_blank(),
axis.line = element_line(color="black"))
)
VIP<-"Data/Part1/NN_VIP_byClass_NoXanth.csv" %>%
read.csv() %>%
mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %>%
dplyr::select(-c(Magnoliosida ,Low_SPC))
VIP1<-VIP %>%
dplyr::select(-c(Water,
SunGlint,
Deep_Sediment,
Bare_Sediment)) %>%
# dplyr::filter(!str_detect(X,"NDVI")) %>%
mutate(isSTD = case_when(str_detect(X,"Stan") ~ "Standardised",
TRUE ~ "RAW")) %>%
pivot_longer(-c(X,isSTD), names_to = "Class",values_to = "value") %>%
dplyr::filter(X != "NDVI",
X != "NDVI_Stan") %>%
group_by(Class) %>%
mutate(STD = (value-min(value))/(max(value)-min(value))) %>%
ungroup() %>%
mutate(Class = case_when(Class == "Magnoliosida" ~ "Magnoliopsida",
Class == "Low_SPC" ~ "Magnoliopsida",
Class == "Clorophyta" ~ "Chlorophyceae",
Class == "Rhodphyta" ~ "Rhodophyceae",
Class == "MPB" ~ "Bacillariophyceae",
Class == "Phaeophyta" ~ "Phaeophyceae",
TRUE ~ Class),
Variable = str_replace_all(str_replace_all(str_replace_all(X,"Reflectance",""),"Stan",""),"_","")) %>%
dplyr::filter(Class != "Total")
VIP_summarised<-VIP1 %>%
group_by(Variable, Class) %>%
dplyr::summarise(sumVIP = sum(STD)) %>%
ungroup() %>%
group_by(Class) %>%
mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))
(VIP_subPLOT<-VIP_summarised %>%
dplyr::filter(Class %in% c("Magnoliopsida", "Chlorophyceae")) %>%
ggplot(aes(x = Variable, y = STD, fill = Class)) +
geom_col(color = "black",position =  "dodge", show.legend = F) +
coord_polar()+
scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
facet_wrap(~Class)+
scale_fill_manual("Class", labels = c("Chlorophyceae", "Magnoliopsida"),
values = c("#b3ff1a", "#389318"))+
theme_Bede()+
theme(panel.grid.major.y = element_line(linetype = "dotted",color = c("grey9","grey9","grey9","grey9",NA)))+
ylab("Importance")+
theme(legend.position="top",
strip.text = element_text(size = 20),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 15),
axis.ticks.y =element_blank(),
axis.title.x =element_blank(),
axis.title.y =element_text(size = 20),
legend.key.size = unit(1, 'cm'),
legend.title = element_text(size=20),
legend.text = element_text(size=20))+
guides(fill = guide_legend(nrow = 1))
)
ggsave("Images/Part1/Fig_VIP.png", VIP_subPLOT, width = 10, height = 5, units = "in", dpi = 300)
ggsave("Images/Part1/Fig_VIP_Spectra.png", SP_plot, width =10, height = 10, units = "in", dpi = 300)
SP_plot
91614+117956+268637+169936+221065+92585+62436
Gafanha_low_ortho <- rast("Data/Part1/Gafanha_low_multi_resampled_colored.tif")
library(tidyverse)
library(terra)
library(sf)
Gafanha_low_ortho <- rast("Data/Part1/Gafanha_low_multi_resampled_colored.tif")
df_test <- as.data.frame(Gafanha_low_ortho)
df_test %>%  dplyr::filter(Gafanha_low_multi_resampled_colored_1 != 0) %>% nrow()
